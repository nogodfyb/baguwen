[![如何知道服务qps.mp4 (10.9MB)](https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*NNs6TKOR3isAAAAAAAAAAABkARQnAQ)](https://www.yuque.com/docs/176646004?_lake_card=%7B%22status%22%3A%22done%22%2C%22name%22%3A%22%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E6%9C%8D%E5%8A%A1qps.mp4%22%2C%22size%22%3A11431094%2C%22taskId%22%3A%22u57761867-a15c-4825-a943-62859dce5ff%22%2C%22taskType%22%3A%22upload%22%2C%22url%22%3Anull%2C%22cover%22%3Anull%2C%22videoId%22%3A%22inputs%2Fprod%2Fyuque%2F2024%2F29413969%2Fmp4%2F1720371162240-688e8e3f-084c-4b75-a734-cb72c5dfbe2f.mp4%22%2C%22download%22%3Afalse%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22SzfX7%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%2C%22card%22%3A%22video%22%7D#SzfX7)最近群里大家都在讨论，如果面试官问到服务的qps，应该是说多少呢。首先这个问题，没有固定的答案，是应该按照一定的套路来说的，只要能自圆其说，就可以。接下来鸡翅老哥就给大家讲讲套路。
## 服务能力的梳理
首先，我们要明确一下，我们这个微服务，到底都对外提供什么样的能力？有哪些接口。先梳理成一个表。每个接口都用于什么场景，然后就是预估接口的qps。怎么预估呢。如果是直接对用户的，就基于用户访问量。如果是对外，就让外部进行提供。这样就得到了一个你的接口需要达到的qps数据。
## 如何考虑机器
按照正常的机器来说一般4核8g是足够的，现在都是容器化的，物理机器上可以承载多个容器，一个容器一个服务，那么如何确定，4核8g到底符不符合你的标准呢。主要是观察cpu的使用率和内存使用率。一般来说。高并发的项目，线程多的话，cpu会高很多，大多数都可以直接扩容来解决，不要去加单台机器的内存和核数，多机器更加分布，而且容错性更高，比如一台机器加了大内存，出了故障，没法解决了，两台机器，一台挂了，另一台还可以用。内存主要是啥呢。首先按照我们现在的web服务来说，内存过于高，如果没有大数据导出的话，那一定是有问题的，基本不太会出现内存搞的问题，如果出现了，需要进行排查。
## 如何知道自己实际能承载的qps呢？
答案只有一个压测！那么这个压测也是有说道的，如果单压一个接口，没压这个服务其他的接口，那么你可能会得到一个很大的值。这个值为单接口的最高qps。还有一种压测就是基于场景同时发压，这样的话，平均多个接口，就可以知道正常使用情况下，一个机器的qps。一般我们就压单个就好，知道单个机器的瓶颈后，后续的一切其实都可以通过扩容来进行解决。
## 一个例子
假设我们现在有一台四核八G的机器，上面部署了一个大家非常喜欢的谷粒商城的商品微服务，主要提供2个接口，一个是基于商品id多线程rpc和数据库查询商品信息的接口 ，一个是基于商品id直接走缓存查询商品名称的接口。<br />那么第一个接口大家就可以说，一台机器300qps。第二个就可以说2000qps。
## 总结
鸡翅老哥最后想说，面试官问的时候，数字不重要，重要是你的思路，你怎么设计的，怎么确定的。

